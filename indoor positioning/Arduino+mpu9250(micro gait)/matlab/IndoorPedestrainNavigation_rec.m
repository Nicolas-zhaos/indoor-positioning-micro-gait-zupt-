
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Error state matrix : delta_x=[delta_fai,  delta_w,      delta_r,    delta_v,   delta_a];
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


clear;
%if micro = 1,Use mircro calibration

micro = 0;

Path ='rec_3_0228.txt';
data = load(Path);
timestamp = data(:,1);
datasize = length(timestamp);

acc_s = data(:,2:4)';
gyro_s = data(:,5:7)';


g0 = 9.78049; %Equatorial gravity acceleration赤道重力加速度
U = 34; %latitude纬度
h = 420; %altitude海拔
g = g0*(1+0.0052884*sin(U)^2 - h*3.14e-7) - 0.0000059*sin(2*U)^2; %Calculate gravity

%Direction angle initialization方向角初始化
pitch = -asin(acc_s(1,1)/g);
roll = atan(acc_s(2,1)/acc_s(3,1));
yaw = 0;

% Conversion from the equipment coordinate system to the navigation coordinate system
C = [cos(pitch)*cos(yaw)    (sin(roll)*sin(pitch)*cos(yaw))-(cos(roll)*sin(yaw))    (cos(roll)*sin(pitch)*cos(yaw))+(sin(roll)*sin(yaw));
    cos(pitch)*sin(yaw)     (sin(roll)*sin(pitch)*sin(yaw))+(cos(roll)*cos(yaw))   (cos(roll)*sin(pitch)*sin(yaw))-(sin(roll)*cos(yaw));
    -sin(pitch)                 sin(roll)*cos(pitch)                                                 cos(roll)*cos(pitch)];
C_pre = C;

% get bias
fid=fopen('biasRec.txt','r');
bias_data=[];
while 1
    tline=fgetl(fid);
    if ~ischar(tline),break;end
    tline=str2num(tline);
    bias_data=[bias_data;tline];
end
fclose(fid);

% Kalman matrix parameter卡尔曼矩阵参数
delta_x = zeros(15,1);
delta_x(4:6) = [bias_data(1); bias_data(2); bias_data(3);];
delta_x(13:15) = [bias_data(4); bias_data(5); bias_data(6)-g;];

%误差矩阵，diagonal 15x15 matrix
%如果P为1，则Gk为1，使用观测值来代表当前的预测值
%如果P为0，则Gk为0，使用上一次的预测值来代表当前的预测值
%因为陀螺仪(4：6)和加速度计(13：15)的数值是有噪声的，所以使用预测值而不是带有噪声的观测值
%Error matrix, 15x15
%If P is 1, then Gk is 1, using the observation value to represent the current prediction value
%If P is 0, then Gk is 0, using the previous prediction value to represent the current prediction value
%Because the values of the gyroscope (4:6) and the accelerometer (13:15) are noisy, the predicted values are used instead of the observed values with noise.
P = diag([1 1 1     0 0 0     1 1 1     1 1 1     0 0 0]);

%观测噪声协方差矩阵 Compass(1),HDR(1),ZARU(3),ZUPT(3)
%R为0，则Gk为1，使用观测值来代表当前的预测
%磁力计由于容易受外界影响，所以方差给的大，表示不是很相信他所得的数据
% observational noise covariance matrix Compass (1), HDR (1), ZARU (3), ZUPT (3)
%R is 0, and Gk is 1, using the observation value to represent the current prediction
%The magnetometer is so large that the variance is given because it is easily influenced by the outside world, indicating that the data is not very confident of the data he gets.
R = diag([ 0 0.01 0.01 0.01 0.01 0.01 0.01]); %Use 0 to indicate a total belief in the value of HDR使用0表示完全相信HDR的值
R2 = diag([ 0.01 0.01 0.01 ]);
% 系统过程噪声协方差矩阵，表示预测模型本身的噪声，初值给的很小
%The system process noise covariance matrix indicates the noise of the prediction model itself, and the initial value is very small.
Q = diag([0.0001 0.0001 0.0001 zeros(1,3) zeros(1,3) 0.0001 0.0001 0.0001  zeros(1,3)]);

% IEZ + HDR + ZARU
H = [[0 0 1]  zeros(1,3) zeros(1,3) zeros(1,3) zeros(1,3);
    zeros(3)  eye(3) zeros(3) zeros(3) zeros(3);
    zeros(3) zeros(3) zeros(3) eye(3) zeros(3)];

H3 = [zeros(3,3) zeros(3,3) zeros(3,3) zeros(3,3) zeros(3,3)];
H3(3,15) = 1;
% Record the acceleration of the navigation frame、velocity、position、heading
acc_n = nan(3,datasize);
acc_n(:,1) = C*acc_s(:,1);


vel_n = nan(3,datasize);
vel_n(:,1) = [0 0 0]';

pos_n = nan(3,datasize);
pos_n(:,1) = [0 0 0]';

distance = nan(1,datasize-1);
distance(1) = 0;


heading = nan(1,datasize);
heading(1) = yaw;

sigma_noise = 1e-4;


yaw_threshold = deg2rad(4);

%Judgment stance phase
isStance = StanceDetection(acc_s, gyro_s, datasize);

% 保守校准后的数据偏差
% Data deviation after conservative calibration（Conservative calibration data subtract data from navigation coordinate system.）
tt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13.5665860300000,13.5665860300000,13.5665860300000,13.5665860300000,13.5665860300000,13.5665860300000,13.5665860300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13.3380011600000,13.3380011600000,13.3380011600000,13.3380011600000,13.3380011600000,13.3380011600000,0,0,12.3420111600000,12.3420111600000,12.3420111600000,12.3420111600000,12.3420111600000,12.3420111600000,12.3420111600000,12.3420111600000,12.3420111600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18.3093800000000,18.3093800000000,18.3093800000000,18.3093800000000,18.3093800000000,18.3093800000000,18.3093800000000,18.3093800000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.0491400000000,17.0491400000000,17.0491400000000,17.0491400000000,17.0491400000000,17.0491400000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.66192942700000,9.66192942700000,9.66192942700000,9.66192942700000,9.66192942700000,9.66192942700000,9.66192942700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.6597353600000,17.6597353600000,17.6597353600000,17.6597353600000,17.6597353600000,17.6597353600000,0,0,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,14.1030400600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.1782953500000,16.1782953500000,16.1782953500000,0,16.8993891800000,16.8993891800000,16.8993891800000,16.8993891800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.7994954600000,17.7994954600000,17.7994954600000,17.7994954600000,17.7994954600000,17.7994954600000,17.7994954600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.9249476300000,16.9249476300000,16.9249476300000,16.9249476300000,16.9249476300000,16.9249476300000,16.9249476300000,16.9249476300000,16.9249476300000,16.9249476300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.4365502000000,17.4365502000000,17.4365502000000,17.4365502000000,17.4365502000000,17.4365502000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.4344008900000,12.4344008900000,12.4344008900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-9.43407500800000,-9.43407500800000,-9.43407500800000,-9.43407500800000,-9.43407500800000,0,0,0,0,16.0782951500000,16.0782951500000,16.0782951500000,16.0782951500000,16.0782951500000,16.0782951500000,16.0782951500000,0,0,0,12.6510430200000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18.0799239800000,18.0799239800000,18.0799239800000,18.0799239800000,18.0799239800000,18.0799239800000,18.0799239800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-8.09326024600000,-8.09326024600000,0,0,0,0,0,0,14.3153060300000,14.3153060300000,14.3153060300000,0,0,16.4767843500000,16.4767843500000,16.4767843500000,0,0,14.4182637800000,14.4182637800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.3162024100000,17.3162024100000,17.3162024100000,17.3162024100000,17.3162024100000,17.3162024100000,17.3162024100000,0,0,0,0,10.7697250700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-11.3479103100000,-11.3479103100000,-11.3479103100000,0,0,0,0,0,16.7738122400000,16.7738122400000,16.7738122400000,16.7738122400000,16.7738122400000,16.7738122400000,16.7738122400000,16.7738122400000,16.7738122400000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18.0286947700000,18.0286947700000,18.0286947700000,18.0286947700000,18.0286947700000,18.0286947700000,18.0286947700000,18.0286947700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-6.93576316000000,-6.93576316000000,-6.93576316000000,-6.93576316000000,-6.93576316000000,-6.93576316000000,0,0,0,0,16.8884676000000,16.8884676000000,16.8884676000000,0,17.1968868400000,17.1968868400000,17.1968868400000,0,0,0,0,0,10.6283065900000,10.6283065900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.5874130300000,17.5874130300000,17.5874130300000,17.5874130300000,17.5874130300000,17.5874130300000,17.5874130300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8.18865900300000,8.18865900300000,0,0,0,0,0,0,0,0,0,0,0,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,13.5967512300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-11.1245666900000,0,0,0,0,0,17.0548184500000,17.0548184500000,17.0548184500000,17.0548184500000,0,17.3445286800000,17.3445286800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.8283944100000,17.8283944100000,17.8283944100000,17.8283944100000,17.8283944100000,17.8283944100000,17.8283944100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.3810857500000,12.3810857500000,12.3810857500000,0,0,0,11.1393537000000,11.1393537000000,11.1393537000000,11.1393537000000,11.1393537000000,11.1393537000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.2400841800000,16.2400841800000,16.2400841800000,0,16.3933046800000,16.3933046800000,16.3933046800000,16.3933046800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.8805854000000,17.8805854000000,17.8805854000000,17.8805854000000,17.8805854000000,17.8805854000000,17.8805854000000,17.8805854000000,0,0,0,0,0,0,0,0,7.77434991700000,7.77434991700000,7.77434991700000,7.77434991700000,7.77434991700000,0,0,0,0,0,0,0,0,11.9396349500000,11.9396349500000,0,0,0,0,12.9323905600000,12.9323905600000,12.9323905600000,0,12.9806945400000,12.9806945400000,12.9806945400000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-2.74394709200000,-2.74394709200000,-2.74394709200000,-2.74394709200000,0,0,-5.65891359000000,0,0,0,0,0,16.9823150000000,16.9823150000000,16.9823150000000,0,17.4906900200000,17.4906900200000,17.4906900200000,17.4906900200000,17.4906900200000,0,0,0,0,10.5934231500000,10.5934231500000,10.5934231500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18.0210974600000,18.0210974600000,18.0210974600000,18.0210974600000,18.0210974600000,18.0210974600000,18.0210974600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13.7142123100000,13.7142123100000,13.7142123100000,0,0,0,0,0,0,0,12.3438659100000,12.3438659100000,12.3438659100000,12.3438659100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-4.75086776300000,-4.75086776300000,-4.75086776300000,-4.75086776300000,0,0,0,0,0,0,0,0,0,0,0,0,0,17.2535858300000,17.2535858300000,17.2535858300000,0,0,0,0,10.5003844500000,10.5003844500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.2179779200000,17.2179779200000,17.2179779200000,17.2179779200000,17.2179779200000,17.2179779200000,17.2179779200000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.89410630500000,9.89410630500000,9.89410630500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-5.74830334800000,-5.74830334800000,0,0,0,15.4299942200000,15.4299942200000,15.4299942200000,0,0,17.3462546500000,17.3462546500000,17.3462546500000,17.3462546500000,17.3462546500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.1674430300000,16.1674430300000,16.1674430300000,16.1674430300000,16.1674430300000,16.1674430300000,16.1674430300000,16.1674430300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.62780077400000,9.62780077400000,9.62780077400000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-3.11011566800000,-3.11011566800000,-3.11011566800000,-3.11011566800000,0,0,0,0,0,0,0,0,0,0,0,0,17.7138436300000,17.7138436300000,17.7138436300000,17.7138436300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10.7004507000000,10.7004507000000,10.7004507000000,0,11.1047994700000,11.1047994700000,11.1047994700000,11.1047994700000,11.1047994700000,11.1047994700000,11.1047994700000,11.1047994700000,11.1047994700000,11.1047994700000,11.1047994700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8.70498572800000,8.70498572800000,0,0,0,0,0,0,0,10.1061725100000,10.1061725100000,10.1061725100000,0,0,0,0,0,0,0,9.65732401700000,9.65732401700000,9.65732401700000,9.65732401700000,9.65732401700000,9.65732401700000,0,0,9.57683026600000,9.57683026600000,9.57683026600000,9.57683026600000,9.57683026600000,9.57683026600000,9.57683026600000,9.57683026600000,0,0,0,0,0,0,0,0,0,6.00469394300000,6.00469394300000,6.00469394300000,0,0.122174417000000,0.122174417000000,0,0,0,0,0,0,0,0,20.2812654500000,20.2812654500000,20.2812654500000,20.2812654500000,20.2812654500000,20.2812654500000,20.2812654500000,20.2812654500000,20.2812654500000,0,0,0,0,9.73583225200000,9.73583225200000,9.73583225200000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15.0526964000000,0,15.2626190100000,15.2626190100000,15.2626190100000,15.2626190100000,15.2626190100000,15.2626190100000,15.2626190100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10.3783603100000,10.3783603100000,10.3783603100000,10.3783603100000,10.3783603100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.0851920800000,11.0851920800000,11.0851920800000,11.0851920800000,11.0851920800000,11.0851920800000,11.0851920800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-8.76439275000000,0,0,0,0,0,16.9977236100000,16.9977236100000,16.9977236100000,16.9977236100000,16.9977236100000,16.9977236100000,16.9977236100000,16.9977236100000,16.9977236100000,16.9977236100000,16.9977236100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.4570551000000,16.4570551000000,16.4570551000000,16.4570551000000,16.4570551000000,16.4570551000000,16.4570551000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.49981682000000,9.49981682000000,9.49981682000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-4.32309619900000,-4.32309619900000,0,0,0,0,0,0,0,0,17.6451606500000,17.6451606500000,17.6451606500000,17.6451606500000,0,18.2655922800000,18.2655922800000,18.2655922800000,18.2655922800000,0,0,0,0,0,11.2058081700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.0027110500000,17.0027110500000,17.0027110500000,17.0027110500000,17.0027110500000,17.0027110500000,17.0027110500000,17.0027110500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8.95192558400000,8.95192558400000,8.95192558400000,8.95192558400000,8.95192558400000,8.95192558400000,8.95192558400000,8.95192558400000,8.95192558400000,8.95192558400000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-4.87237308300000,-4.87237308300000,0,0,0,0,0,16.6042038900000,16.6042038900000,16.6042038900000,0,0,17.8671664500000,17.8671664500000,17.8671664500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14.6134570500000,14.6134570500000,14.6134570500000,14.6134570500000,14.6134570500000,14.6134570500000,14.6134570500000,14.6134570500000,14.6134570500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.69815044000000,6.69815044000000,6.69815044000000,6.69815044000000,6.69815044000000,6.69815044000000,6.69815044000000,0,0,0,0,0,0,0,12.1629663700000,12.1629663700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.27580975800000,9.27580975800000,9.27580975800000,9.27580975800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.5519956900000,11.5519956900000,11.5519956900000,11.5519956900000,11.5519956900000,0,0,0,0,0,0,0,0,0,0,0,8.62219182200000,8.62219182200000,8.62219182200000,8.62219182200000,8.62219182200000,0,0,0,0,0,0,0,0,0,0,0,0,0,2.50007547200000,2.50007547200000,0,0,0,14.9423177300000,14.9423177300000,14.9423177300000,0,17.9086154100000,17.9086154100000,0,0,0,11.2395632700000,0,10.1325136900000,10.1325136900000,10.1325136900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.5873251300000,16.5873251300000,16.5873251300000,16.5873251300000,16.5873251300000,16.5873251300000,16.5873251300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.8039569100000,11.8039569100000,11.8039569100000,11.8039569100000,11.8039569100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.41239482200000,1.41239482200000,1.41239482200000,0,-3.66061983200000,-3.66061983200000,-3.66061983200000,-3.66061983200000,-3.66061983200000,-3.66061983200000,0,0,0,0,17.9020519200000,17.9020519200000,17.9020519200000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.5374668500000,17.5374668500000,17.5374668500000,17.5374668500000,17.5374668500000,17.5374668500000,17.5374668500000,0,0,0,0,0,0,0,0,0,7.76293288500000,7.76293288500000,7.76293288500000,7.76293288500000,0,0,0,0,0,0,11.9223894900000,11.9223894900000,11.9223894900000,11.9223894900000,0,0,0,12.8475533800000,12.8475533800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.05361750500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13.8400120400000,13.8400120400000,13.8400120400000,0,0,0,18.0846405100000,18.0846405100000,18.0846405100000,0,0,0,0,10.7279996900000,10.7279996900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.9606528500000,16.9606528500000,16.9606528500000,16.9606528500000,16.9606528500000,16.9606528500000,16.9606528500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.2373627800000,12.2373627800000,12.2373627800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.4621144300000,17.4621144300000,17.4621144300000,17.4621144300000,17.4621144300000,17.4621144300000,17.4621144300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.0291328300000,17.0291328300000,17.0291328300000,17.0291328300000,17.0291328300000,17.0291328300000,17.0291328300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.4545547500000,11.4545547500000,11.4545547500000,11.4545547500000,11.4545547500000,11.4545547500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.8048408100000,16.8048408100000,16.8048408100000,16.8048408100000,16.8048408100000,16.8048408100000,16.8048408100000,16.8048408100000,16.8048408100000,0,0,0,0,0,10.8312608000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.8875947800000,16.8875947800000,16.8875947800000,16.8875947800000,16.8875947800000,16.8875947800000,16.8875947800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.9866174900000,11.9866174900000,11.9866174900000,11.9866174900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-6.71915105300000,-6.71915105300000,0,0,0,0,14.1423651100000,14.1423651100000,14.1423651100000,0,0,17.0258334400000,17.0258334400000,17.0258334400000,17.0258334400000,17.0258334400000,0,0,0,0,0,9.77480870900000,9.77480870900000,9.77480870900000,9.77480870900000,9.77480870900000,9.77480870900000,9.77480870900000,9.77480870900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.0093328800000,16.0093328800000,16.0093328800000,16.0093328800000,16.0093328800000,16.0093328800000,16.0093328800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.1125241600000,12.1125241600000,12.1125241600000,12.1125241600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.6488708000000,17.6488708000000,17.6488708000000,17.6488708000000,0,17.9834309100000,17.9834309100000,17.9834309100000,0,0,0,0,0,10.5161670000000,10.5161670000000,10.5161670000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14.9597946900000,14.9597946900000,14.9597946900000,14.9597946900000,14.9597946900000,14.9597946900000,14.9597946900000,0,0,0,0,0,0,6.54072311000000,6.54072311000000,6.54072311000000,6.54072311000000,0,0,0,0,0,0,0,0,0,10.8308507400000,10.8308507400000,10.8308507400000,10.8308507400000,10.8308507400000,10.8308507400000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10.6585304900000,10.6585304900000,10.6585304900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-5.31877950800000,0,0,0,0,0,0,17.5102432200000,17.5102432200000,17.5102432200000,17.5102432200000,17.5102432200000,17.5102432200000,17.5102432200000,17.5102432200000,17.5102432200000,17.5102432200000,0,0,0,0,0,10.4821018100000,10.4821018100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.3677741700000,16.3677741700000,16.3677741700000,16.3677741700000,16.3677741700000,16.3677741700000,16.3677741700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.3911966600000,12.3911966600000,12.3911966600000,12.3911966600000,12.3911966600000,12.3911966600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-2.12150010200000,-2.12150010200000,0,-6.14364896800000,0,0,0,0,0,0,16.8536783500000,16.8536783500000,16.8536783500000,0,0,0,17.7029631100000,17.7029631100000,17.7029631100000,17.7029631100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.5726855000000,16.5726855000000,16.5726855000000,16.5726855000000,16.5726855000000,16.5726855000000,16.5726855000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10.5636729500000,10.5636729500000,10.5636729500000,10.5636729500000,10.5636729500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.62212249700000,9.62212249700000,9.62212249700000,9.62212249700000,9.62212249700000,9.62212249700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15.9815865900000,15.9815865900000,15.9815865900000,15.9815865900000,15.9815865900000,0,16.5899137900000,16.5899137900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.8609620100000,16.8609620100000,16.8609620100000,16.8609620100000,16.8609620100000,16.8609620100000,16.8609620100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.67279846200000,9.67279846200000,9.67279846200000,9.67279846200000,9.67279846200000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.01375001000000,9.01375001000000,9.01375001000000,9.01375001000000,9.01375001000000,9.01375001000000,9.01375001000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-6.07258929600000,-6.07258929600000,-6.07258929600000,0,0,0,0,0,16.9073534400000,16.9073534400000,0,0,17.7803207600000,17.7803207600000,17.7803207600000,17.7803207600000,17.7803207600000,17.7803207600000,0,0,0,0,0,10.6305679900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.8866194800000,17.8866194800000,17.8866194800000,17.8866194800000,17.8866194800000,17.8866194800000,17.8866194800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.1866620600000,11.1866620600000,11.1866620600000,11.1866620600000,11.1866620600000,11.1866620600000,11.1866620600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7.40904106400000,7.40904106400000,7.40904106400000,7.40904106400000,7.40904106400000,7.40904106400000,0,0,0,0,0,0,0,0,0,0,0,0,-7.56721845200000,0,0,0,0,0,0,0,18.0588301000000,18.0588301000000,18.0588301000000,18.0588301000000,18.0588301000000,18.0588301000000,18.0588301000000,18.0588301000000,18.0588301000000,0,0,16.1336531700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.8144827400000,17.8144827400000,17.8144827400000,17.8144827400000,17.8144827400000,17.8144827400000,17.8144827400000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10.9169644800000,10.9169644800000,10.9169644800000,10.9169644800000,10.9169644800000,0,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,9.90066992600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.2989244800000,17.2989244800000,17.2989244800000,17.2989244800000,17.2989244800000,17.2989244800000,17.2989244800000,17.2989244800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.77376369300000,9.77376369300000,9.77376369300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.56698008300000,9.56698008300000,9.56698008300000,9.56698008300000,9.56698008300000,9.56698008300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-4.27102056200000,0,-7.09503746600000,-7.09503746600000,-7.09503746600000,0,0,0,0,15.3599422200000,15.3599422200000,15.3599422200000,0,0,17.4857599300000,17.4857599300000,0,0,0,0,11.6128890200000,11.6128890200000,11.6128890200000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14.3065259700000,14.3065259700000,14.3065259700000,14.3065259700000,14.3065259700000,14.3065259700000,14.3065259700000,0,0,0,0,0,0,0,0,0,5.91009384900000,5.91009384900000,5.91009384900000,5.91009384900000,5.91009384900000,5.91009384900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10.8524575000000,10.8524575000000,10.8524575000000,10.8524575000000,0,0,0,0,0,0,3.31971335500000,3.31971335500000,3.31971335500000,3.31971335500000,3.31971335500000,3.31971335500000,3.31971335500000,3.31971335500000,3.31971335500000,0,1.91671526100000,1.91671526100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.1484978500000,11.1484978500000,11.1484978500000,11.1484978500000,11.1484978500000,11.1484978500000,11.1484978500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.55976989500000,9.55976989500000,9.55976989500000,0,0,0,0,0,0,3.27061259600000,0,0,0,0,0,0,0,0,0,0,0,0,19.9380965000000,19.9380965000000,19.9380965000000,0,0,0,16.6974715600000,16.6974715600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.4557912500000,16.4557912500000,16.4557912500000,16.4557912500000,16.4557912500000,16.4557912500000,16.4557912500000,16.4557912500000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.9783384100000,12.9783384100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.43120433300000,3.43120433300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.9948843000000,16.9948843000000,0,0,17.5957971200000,17.5957971200000,17.5957971200000,0,0,0,0,0,10.5394449000000,10.5394449000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.6515551600000,17.6515551600000,17.6515551600000,17.6515551600000,17.6515551600000,17.6515551600000,17.6515551600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.8294244000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.38217696600000,9.38217696600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.4329708400000,17.4329708400000,17.4329708400000,17.4329708400000,17.4329708400000,17.4329708400000,0,0,0,0,0,10.3364733300000,10.3364733300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.4971294600000,17.4971294600000,17.4971294600000,17.4971294600000,17.4971294600000,17.4971294600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.4249009600000,11.4249009600000,11.4249009600000,11.4249009600000,11.4249009600000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.9488128300000,11.9488128300000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-3.83871859500000,0,0,-6.94762403000000,-6.94762403000000,0,0,0,0,0,17.0574712900000,17.0574712900000,17.0574712900000,0,0,17.3223914800000,17.3223914800000,17.3223914800000,0,0,13.7659617100000,13.7659617100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13.9261100700000,13.9261100700000,13.9261100700000,13.9261100700000,13.9261100700000,13.9261100700000,13.9261100700000,13.9261100700000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8.99413679900000,8.99413679900000,8.99413679900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7.55563450500000,7.55563450500000,7.55563450500000,7.55563450500000,0,0,0,0,5.84137212200000,5.84137212200000,5.84137212200000,5.84137212200000,5.84137212200000,5.84137212200000,0,3.67578612500000,0,0,0,0,0,6.33366332900000,6.33366332900000,0,0,0,0,0,10.3515724900000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

%% main loop
for t = 2:datasize
    dt = timestamp(t) - timestamp(t-1); %translate time
    
    % first phase:gyro acc Remove bias
    gyro_s1 = gyro_s(:,t) - delta_x(4:6);
    
    
    % second phase:Angular rate anti symmetric matrix角速率反对称矩阵
    delta_omiga = [0              -gyro_s1(3)     gyro_s1(2);
                   gyro_s1(3)     0               -gyro_s1(1);
                  -gyro_s1(2)   gyro_s1(1)     0];
    
    % 方向转换矩阵的计算 
    % calculate the direction transition matrix
    C = C_pre*(2*eye(3)+(delta_omiga*dt))/(2*eye(3)-(delta_omiga*dt));
    
    %更新方向角
    % update direction angle
    pitch = -asin(C(3,1));
    roll = atan(C(3,2)/C(3,3));
    yaw = atan(C(2,1)/C(1,1));
   
    %third phase:加速度转换框架
    acc_n(:,t) = 0.5*(C + C_pre)*(acc_s(:,t)-delta_x(13:15));
    
	
     %%micro gait--------------------------------------------
  if micro==1
    K = (P*(H3)')/((H3)*P*(H3)' + R2); %
        
        m = [tt(:,t)];% error observation matrix
        
        delta_x = delta_x + K*(m - H3*delta_x);
        
        P = (eye(15) - K*H3)*P;
        
          acc_n(:,t)=acc_n(:,t) - delta_x(13:15);
        
        %recovery error state恢复误差状态
        delta_x(13:15) = zeros(3,1);
    %%--------------------------------------------------------
  end 
  
  
    %fourth phase:get velocity and position
    vel_n(:,t) = vel_n(:,t-1) + (acc_n(:,t) - [0; 0; g] )*dt;
    pos_n(:,t) = pos_n(:,t-1) + vel_n(:,t)*dt;
    
   
    S = [0             -acc_n(3)   acc_n(2);
         acc_n(3)       0           -acc_n(1);
        -acc_n(2)       acc_n(1)       0];
    
    % % state transition matrix状态转移矩阵，
    F = [eye(3)        dt*C    zeros(3)  zeros(3)   zeros(3);
        zeros(3)      eye(3)        zeros(3)  zeros(3)   zeros(3);
        zeros(3)      zeros(3)     eye(3)     dt*eye(3) zeros(3)
        -dt*S          zeros(3)     zeros(3)   eye(3)     dt*C
        zeros(3)      zeros(3)     zeros(3)   zeros(3)  eye(3)];
    
    % % prediction预测
    delta_x = F*delta_x;
    P = F*P*F' + Q;
  
    
    %%HDR
    ret_yaw = HDR(yaw, heading,t);
    
    if(abs(ret_yaw) < yaw_threshold)
        delta_yaw_hdr = ret_yaw;
    else
        delta_yaw_hdr = 0;
    end
    
    % judge stance
    if(isStance(t) == 1)
        K = (P*(H)')/((H)*P*(H)' + R); 
        
        m = [delta_yaw_hdr;
            ZARU(gyro_s(:,t));
            (vel_n(:,t) - [0 0 0]')];
        
        delta_x = delta_x + K*(m - H*delta_x);
        
        % % updated noise covariance matrix
        P = (eye(15) - K*H)*P;
        
        %%更新姿态
		%update attitude
        ang_matrix = -[0            -delta_x(3)    delta_x(2);
            delta_x(3)         0         -delta_x(1);
            -delta_x(2)  delta_x(1)         0];
        
        C = (2*eye(3)+(ang_matrix))/(2*eye(3)-(ang_matrix))*C;
        
        %fifth phase:% calibration
        vel_n(:,t)=vel_n(:,t) - delta_x(10:12);
        pos_n(:,t)=pos_n(:,t) - delta_x(7:9);
        
        %% recovery error state恢复误差状态
        delta_x(1:3) = zeros(3,1);
        delta_x(7:9) = zeros(3,1);
        delta_x(10:12) = zeros(3,1);
        
    end
    
    
    heading(t) = yaw; %保存yaw角 save yaw data
    C_pre = C; % 保存方向 save direction data
    distance(1,t) = distance(1,t-1) + sqrt((pos_n(1,t)-pos_n(1,t-1))^2 + (pos_n(2,t)-pos_n(2,t-1))^2);% 计算距离 calculate distance
end


%绘制轨迹
%plot trajectory
figure;
box on;
hold on;
angle = 180; %要求达到图片审美对齐的角度，所以旋转图形 The point of view of the aesthetic alignment of the picture ，so rotating graphics
rotation_matrix = [cosd(angle)  -sind(angle);
    sind(angle)   cosd(angle)];

pos_r = zeros(2,datasize);

for idx = 1:datasize
    pos_r(:,idx) = rotation_matrix*[pos_n(1,idx) pos_n(2,idx)]';
end
%绘制路线 Draw a route
plot(pos_r(1,:),pos_r(2,:),'LineWidth',2,'Color','r');
%绘制开始符号 Draw the start symbol
start = plot(pos_r(1,1),pos_r(2,1),'Marker','^','LineWidth',1,'LineStyle','none');
%绘制结束符号 Draw the end symbol
stop = plot(pos_r(1,end),pos_r(2,end),'Marker','o','LineWidth',1,'LineStyle','none');

xlabel('x (m)');
ylabel('y (m)');
title('平面路线估计');
legend([start;stop],'开始','结束');
axis equal;
grid;
hold off;
